language: go
go:
    - "1.10"

before_install:
    - curl https://sh.rustup.rs -sSf | sh -s -- -y
    - export PATH=~/.cargo/bin:$PATH
    - mkdir tmp
    - git clone https://github.com/macarrie/vidocq tmp/vidocq
    - cd tmp/vidocq && cargo build --release && cd -
    - cp tmp/vidocq/target/release/vidocq /usr/bin/vidocq

install:
    - go get -u golang.org/x/vgo

before_script:
    - vgo vet ./...

script:
    - make test

after_success:
  - bash <(curl -s https://codecov.io/bash)
