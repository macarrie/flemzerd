language: go
go:
    - "1.10"

before_install:
    - curl https://sh.rustup.rs -sSf | sh -s -- -y
    - export PATH=~/.cargo/bin:$PATH
    - mkdir tmp
    - git clone https://github.com/macarrie/vidocq tmp/vidocq
    - push tmp/vidocq && cargo build --release && popd
    - export PATH=$PATH:tmp/vidocq/target/release/

install:
    - go get -u golang.org/x/vgo

script:
    - vgo vet ./...
    - make test

after_success:
  - bash <(curl -s https://codecov.io/bash)
